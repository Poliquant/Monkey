<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Prompt Monkeys - Financial Community Chat</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #1DB954;
            --primary-light: #4cd97f;
            --primary-dark: #1AA34A;
            --secondary: #191414;
            --accent: #1ED760;
            --background: #121212;
            --card-bg: #1f1f1f;
            --card-hover: #2a2a2a;
            --text: #FFFFFF;
            --text-light: #B3B3B3;
            --text-lighter: #888;
            --border: #333;
            --border-light: #444;
            --upvote: #1DB954;
            --downvote: #FF4D4D;
            --admin-color: #1DB954;
            --moderator-color: #4a89dc;
            --notification: #1DB954;
            --error: #e74c3c;
            --success: #2ecc71;
            --warning: #f39c12;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Roboto', 'Helvetica Neue', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: var(--background);
            color: var(--text);
            line-height: 1.6;
            touch-action: manipulation;
            padding-top: 70px;
            padding-bottom: 20px;
        }

        /* Header Styles */
        .header {
            background-color: var(--secondary);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid var(--primary);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
        }

        .logo-icon {
            font-size: 1.5rem;
            color: var(--primary);
            transition: transform 0.3s ease;
        }

        .logo:hover .logo-icon {
            transform: rotate(15deg);
        }

        .logo-text {
            color: var(--primary);
            font-size: 1.4rem;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .nav-links {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            padding-bottom: 5px;
        }

        .nav-links::-webkit-scrollbar {
            display: none;
        }

        .nav-link {
            color: var(--text-light);
            text-decoration: none;
            font-weight: 600;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            white-space: nowrap;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-link i {
            font-size: 0.9rem;
        }

        .nav-link:hover, .nav-link.active {
            background-color: rgba(29, 185, 84, 0.15);
            color: var(--primary);
        }

        .nav-link.active {
            background-color: rgba(29, 185, 84, 0.25);
        }

        /* Main Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        @media (min-width: 992px) {
            .container {
                grid-template-columns: 1fr 300px;
            }
        }

        /* Welcome Banner */
        .welcome-banner {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(29, 185, 84, 0.2);
            grid-column: 1 / -1;
        }

        .welcome-title {
            font-size: 1.8rem;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .welcome-subtitle {
            font-size: 1.1rem;
            margin-bottom: 20px;
            opacity: 0.9;
        }

        /* Posts Container */
        .posts-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* Post Styles */
        .post {
            background-color: var(--card-bg);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid var(--border);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .post:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
            border-color: var(--primary);
        }

        .post-header {
            padding: 18px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .post-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .post-info {
            flex-grow: 1;
        }

        .post-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--text);
        }

        .post-meta {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.85rem;
            color: var(--text-light);
            flex-wrap: wrap;
        }

        .badge {
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .badge-admin {
            background-color: var(--admin-color);
            color: white;
        }

        .badge-moderator {
            background-color: var(--moderator-color);
            color: white;
        }

        .post-time {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .post-time i {
            font-size: 0.8rem;
        }

        .post-content {
            padding: 18px;
            font-size: 1rem;
            line-height: 1.7;
        }

        .post-content p {
            margin-bottom: 15px;
        }

        .post-content p:last-child {
            margin-bottom: 0;
        }

        .post-actions {
            padding: 12px 18px;
            display: flex;
            gap: 15px;
            border-top: 1px solid var(--border);
            flex-wrap: wrap;
        }

        .action-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 15px;
            border-radius: 20px;
            background-color: transparent;
            border: none;
            color: var(--text-light);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .action-btn.upvote:hover {
            color: var(--upvote);
        }

        .action-btn.downvote:hover {
            color: var(--downvote);
        }

        .action-btn.active {
            color: var(--primary);
            background-color: rgba(29, 185, 84, 0.1);
        }

        .action-btn.upvote.active {
            color: var(--upvote);
        }

        .action-btn.downvote.active {
            color: var(--downvote);
        }

        /* Comments Section */
        .comments-section {
            padding: 0 18px 18px;
        }

        .comments-title {
            font-size: 1.1rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-light);
        }

        .comment-form {
            margin-bottom: 25px;
            background-color: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid var(--border-light);
        }

        .comment-form-title {
            font-size: 1rem;
            margin-bottom: 12px;
            color: var(--text-light);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .comment-textarea {
            width: 100%;
            padding: 12px 15px;
            background-color: var(--background);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text);
            font-size: 0.95rem;
            min-height: 100px;
            margin-bottom: 12px;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        .comment-textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        .comment-submit {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: var(--primary);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            text-decoration: none;
            font-weight: 600;
            font-size: 0.95rem;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .comment-submit:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(29, 185, 84, 0.3);
        }

        .comments-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .comment {
            background-color: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid var(--border-light);
        }

        .comment-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 10px;
        }

        .comment-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background-color: var(--primary-dark);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .comment-user {
            font-weight: 600;
            font-size: 0.95rem;
        }

        .comment-time {
            font-size: 0.8rem;
            color: var(--text-light);
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .comment-content {
            font-size: 0.95rem;
            line-height: 1.6;
            padding-left: 47px;
        }

        .comment-actions {
            display: flex;
            gap: 12px;
            margin-top: 12px;
            padding-left: 47px;
        }

        /* Sidebar Styles */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .sidebar-card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--border);
        }

        .sidebar-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--primary);
        }

        .rules-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .rule-item {
            display: flex;
            gap: 12px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }

        .rule-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .rule-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: rgba(29, 185, 84, 0.1);
            color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            flex-shrink: 0;
        }

        .rule-content {
            flex-grow: 1;
        }

        .rule-title {
            font-size: 0.95rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .rule-description {
            font-size: 0.85rem;
            color: var(--text-light);
            line-height: 1.5;
        }

        .advertise-btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            font-size: 0.95rem;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            justify-content: center;
            margin-top: 10px;
        }

        .advertise-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(29, 185, 84, 0.3);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 15px;
        }

        .stat-box {
            background-color: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border: 1px solid var(--border-light);
        }

        .stat-number {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--text-light);
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 80px;
            right: 20px;
            padding: 12px 20px;
            border-radius: 8px;
            background-color: var(--notification);
            color: white;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1000;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .notification.show {
            opacity: 1;
            transform: translateY(0);
        }

        .notification.error {
            background-color: var(--error);
        }

        .notification.success {
            background-color: var(--success);
        }

        .notification.warning {
            background-color: var(--warning);
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .header {
                padding: 10px 15px;
            }
            
            .logo-text {
                font-size: 1.2rem;
            }
            
            .nav-link {
                padding: 6px 12px;
                font-size: 0.85rem;
            }
            
            .container {
                padding: 15px;
            }
            
            .welcome-banner {
                padding: 20px;
            }
            
            .welcome-title {
                font-size: 1.5rem;
            }
            
            .welcome-subtitle {
                font-size: 1rem;
            }
            
            .post-header {
                padding: 15px;
            }
            
            .post-title {
                font-size: 1.1rem;
            }
        }

        @media (max-width: 480px) {
            body {
                padding-top: 60px;
            }
            
            .logo-text {
                font-size: 1.1rem;
            }
            
            .nav-link {
                padding: 6px 10px;
                font-size: 0.8rem;
            }
            
            .nav-link i {
                display: none;
            }
            
            .post-avatar {
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }
            
            .comment-avatar {
                width: 30px;
                height: 30px;
                font-size: 0.8rem;
            }
            
            .comment-content {
                padding-left: 42px;
            }
            
            .comment-actions {
                padding-left: 42px;
            }
        }

        /* Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.4s ease forwards;
        }
    </style>
</head>
<body>
    <div class="notification" id="notification"></div>

    <header class="header">
        <a href="index.html" class="logo">
            <div class="logo-icon"><i class="fas fa-monkey"></i></div>
            <div class="logo-text">Prompt Monkeys</div>
        </a>
        <nav class="nav-links">
            <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Home</a>
            <a href="chat.html" class="nav-link active"><i class="fas fa-comments"></i> Chat</a>
            <a href="earnings.html" class="nav-link"><i class="fas fa-chart-line"></i> Earnings</a>
            <a href="advertise.html" class="nav-link"><i class="fas fa-bullhorn"></i> Advertise</a>
            <a href="admin-login.html" class="nav-link"><i class="fas fa-lock"></i> Admin</a>
        </nav>
    </header>

    <div class="container">
        <div class="welcome-banner">
            <h1 class="welcome-title">Financial Insights Community</h1>
            <p class="welcome-subtitle">Engage with expert analysis, market trends, and investment discussions</p>
        </div>

        <main class="posts-container" id="postsContainer">
            <!-- Posts will be dynamically inserted here -->
        </main>

        <aside class="sidebar">
            <div class="sidebar-card">
                <h2 class="sidebar-title"><i class="fas fa-gavel"></i> Community Rules</h2>
                <div class="rules-list">
                    <div class="rule-item">
                        <div class="rule-icon"><i class="fas fa-user-shield"></i></div>
                        <div class="rule-content">
                            <h3 class="rule-title">Admin-Only Posts</h3>
                            <p class="rule-description">Only verified admins can create new discussion topics to ensure quality content.</p>
                        </div>
                    </div>
                    <div class="rule-item">
                        <div class="rule-icon"><i class="fas fa-handshake"></i></div>
                        <div class="rule-content">
                            <h3 class="rule-title">Respectful Dialogue</h3>
                            <p class="rule-description">Maintain a professional and respectful tone in all discussions.</p>
                        </div>
                    </div>
                    <div class="rule-item">
                        <div class="rule-icon"><i class="fas fa-comment-slash"></i></div>
                        <div class="rule-content">
                            <h3 class="rule-title">Back Up Opinions</h3>
                            <p class="rule-description">Share insights with supporting evidence and data when possible.</p>
                        </div>
                    </div>
                </div>
                <button class="advertise-btn" onclick="window.location.href='advertise.html'">
                    <i class="fas fa-bullhorn"></i> Advertise With Us
                </button>
            </div>

            <div class="sidebar-card">
                <h2 class="sidebar-title"><i class="fas fa-chart-bar"></i> Community Stats</h2>
                <div class="stats-grid">
                    <div class="stat-box">
                        <div class="stat-number" id="totalPosts">0</div>
                        <div class="stat-label">Total Posts</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="totalComments">0</div>
                        <div class="stat-label">Total Comments</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="activeUsers">0</div>
                        <div class="stat-label">Active Users</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="dailyPosts">0</div>
                        <div class="stat-label">Today's Posts</div>
                    </div>
                </div>
            </div>
        </aside>
    </div>

    <script>
        // Time formatting function
        function formatTime(date) {
            const now = new Date();
            const postDate = new Date(date);
            const diffInSeconds = Math.floor((now - postDate) / 1000);
            
            if (diffInSeconds < 60) return `${diffInSeconds}s ago`;
            if (diffInSeconds < 3600) return `${Math.floor(diffInSeconds / 60)}m ago`;
            if (diffInSeconds < 86400) return `${Math.floor(diffInSeconds / 3600)}h ago`;
            if (diffInSeconds < 604800) return `${Math.floor(diffInSeconds / 86400)}d ago`;
            return postDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        }

        // Sample data for demonstration
        const samplePosts = [
            {
                id: 1,
                title: "Bitcoin Analysis: Bullish Signals Emerging",
                author: "CryptoExpert",
                content: `<p>Recent on-chain data shows strong accumulation by large holders, suggesting institutional interest is growing. The Puell Multiple, which measures miner revenue relative to yearly averages, has dipped into the green zone historically associated with early bull markets.</p>
                <p>Key resistance at $65K needs to be broken for confirmation of a new upward trend. Support remains strong at $58K-$60K. My medium-term target remains $85K by Q3, with potential for $100K+ if ETF inflows continue at current pace.</p>`,
                upvotes: 142,
                downvotes: 8,
                created_at: new Date(Date.now() - 7200000).toISOString(),
                is_admin: true,
                comments: [
                    {
                        id: 1,
                        author: "CryptoTrader",
                        content: "Great analysis! What's your take on the recent miner capitulation? Could that delay the bull run?",
                        upvotes: 15,
                        downvotes: 2,
                        created_at: new Date(Date.now() - 3600000).toISOString(),
                        is_admin: false
                    },
                    {
                        id: 2,
                        author: "Investor123",
                        content: "I agree with the $85K target. The halving effects typically show 9-12 months later, which aligns with your Q3 projection.",
                        upvotes: 8,
                        downvotes: 0,
                        created_at: new Date(Date.now() - 1800000).toISOString(),
                        is_admin: false
                    }
                ]
            },
            {
                id: 2,
                title: "Tech Earnings Preview: Focus on Cloud & AI Growth",
                author: "MarketAnalyst",
                content: `<p>Big tech earnings begin next week with MSFT, GOOGL, and META reporting. Key focus areas:</p>
                <ul>
                    <li>Azure/Google Cloud growth rates - watch for stabilization</li>
                    <li>AI monetization progress - especially Copilot adoption</li>
                    <li>Advertising trends - consumer spending indicators</li>
                    <li>Capital expenditure guidance - AI infrastructure investments</li>
                </ul>
                <p>MSFT remains my top pick given diversified exposure and leading position in enterprise AI.</p>`,
                upvotes: 98,
                downvotes: 12,
                created_at: new Date(Date.now() - 18000000).toISOString(),
                is_admin: true,
                comments: [
                    {
                        id: 3,
                        author: "TechInvestor",
                        content: "What about AMZN? Their AWS growth has been accelerating and they're making big moves in AI with Bedrock.",
                        upvotes: 12,
                        downvotes: 1,
                        created_at: new Date(Date.now() - 10800000).toISOString(),
                        is_admin: false
                    },
                    {
                        id: 4,
                        author: "QuantTrader",
                        content: "I'm watching the capex guidance closely. If they signal slowdown in AI investments, that could hit chip stocks.",
                        upvotes: 6,
                        downvotes: 0,
                        created_at: new Date(Date.now() - 5400000).toISOString(),
                        is_admin: false
                    }
                ]
            },
            {
                id: 3,
                title: "Fed Meeting Preview: Rate Cut Expectations",
                author: "FinanceGuru",
                content: `<p>The Fed meets next week with markets pricing in:</p>
                <ul>
                    <li>85% chance of no change to rates</li>
                    <li>15% chance of 25bps cut</li>
                    <li>Dot plot revisions will be key - watch for 2024 median projection</li>
                </ul>
                <p>My view: Powell will maintain hawkish tone but signal openness to cuts if inflation data cooperates. September remains most likely start date for easing cycle.</p>`,
                upvotes: 76,
                downvotes: 5,
                created_at: new Date(Date.now() - 28800000).toISOString(),
                is_admin: true,
                comments: [
                    {
                        id: 5,
                        author: "BondTrader",
                        content: "The 2-10 yield curve is steepening again. That usually precedes rate cuts by 6-9 months. Agree with your September call.",
                        upvotes: 9,
                        downvotes: 0,
                        created_at: new Date(Date.now() - 14400000).toISOString(),
                        is_admin: false
                    }
                ]
            }
        ];

        // UI Controller
        const uiController = {
            currentUser: null,
            votedPosts: new Set(),
            votedComments: new Set(),

            init() {
                this.renderPosts();
                this.setupEventListeners();
                this.simulateActiveUsers();
            },

            renderPosts() {
                const postsContainer = document.getElementById('postsContainer');
                postsContainer.innerHTML = '';

                if (samplePosts.length === 0) {
                    postsContainer.innerHTML = `
                        <div class="post">
                            <div class="post-content" style="text-align: center; padding: 40px 15px;">
                                <h3 style="color: var(--primary); margin-bottom: 15px;">No Posts Yet</h3>
                                <p>Check back later for new financial insights!</p>
                            </div>
                        </div>
                    `;
                    return;
                }

                samplePosts.forEach(post => {
                    const postElement = document.createElement('article');
                    postElement.className = 'post fade-in';
                    postElement.innerHTML = `
                        <div class="post-header">
                            <div class="post-avatar">${post.author.charAt(0)}</div>
                            <div class="post-info">
                                <h2 class="post-title">${post.title}</h2>
                                <div class="post-meta">
                                    <span>${post.author}</span>
                                    ${post.is_admin ? '<span class="badge badge-admin">Admin</span>' : ''}
                                    <span class="post-time">
                                        <i class="far fa-clock"></i>
                                        <span>${formatTime(post.created_at)}</span>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="post-content">
                            ${post.content}
                        </div>
                        <div class="post-actions">
                            <button class="action-btn upvote ${this.votedPosts.has(post.id) ? 'active' : ''}" data-post="${post.id}">
                                <i class="fas fa-arrow-up"></i>
                                <span class="vote-count">${post.upvotes}</span>
                            </button>
                            <button class="action-btn downvote" data-post="${post.id}">
                                <i class="fas fa-arrow-down"></i>
                                <span class="vote-count">${post.downvotes}</span>
                            </button>
                            <button class="action-btn">
                                <i class="far fa-comment"></i>
                                <span>${post.comments.length}</span>
                            </button>
                            <button class="action-btn">
                                <i class="far fa-bookmark"></i>
                                <span>Save</span>
                            </button>
                        </div>
                        <div class="comments-section">
                            <div class="comment-form" data-post="${post.id}">
                                <h3 class="comment-form-title"><i class="fas fa-comment-dots"></i> Add Your Comment</h3>
                                <textarea class="comment-textarea" placeholder="Share your thoughts on this analysis..."></textarea>
                                <button class="comment-submit"><i class="fas fa-paper-plane"></i> Post Comment</button>
                            </div>
                            <div class="comments-list" id="comments-${post.id}"></div>
                        </div>
                    `;
                    postsContainer.appendChild(postElement);
                    this.renderComments(post.id, post.comments);
                });

                this.updateStats();
            },

            renderComments(postId, comments) {
                const commentsList = document.getElementById(`comments-${postId}`);
                if (!commentsList) return;

                commentsList.innerHTML = '';

                if (comments.length === 0) {
                    return;
                }

                comments.forEach(comment => {
                    const commentElement = document.createElement('div');
                    commentElement.className = 'comment fade-in';
                    commentElement.innerHTML = `
                        <div class="comment-header">
                            <div class="comment-avatar">${comment.author.charAt(0)}</div>
                            <div class="comment-user">${comment.author}</div>
                            <div class="comment-time">
                                <i class="far fa-clock"></i>
                                <span>${formatTime(comment.created_at)}</span>
                            </div>
                        </div>
                        <div class="comment-content">
                            <p>${comment.content}</p>
                        </div>
                        <div class="comment-actions">
                            <button class="action-btn upvote ${this.votedComments.has(comment.id) ? 'active' : ''}" data-comment="${comment.id}">
                                <i class="fas fa-arrow-up"></i>
                                <span class="vote-count">${comment.upvotes}</span>
                            </button>
                            <button class="action-btn downvote" data-comment="${comment.id}">
                                <i class="fas fa-arrow-down"></i>
                                <span class="vote-count">${comment.downvotes}</span>
                            </button>
                            <button class="action-btn">
                                <i class="fas fa-reply"></i>
                                <span>Reply</span>
                            </button>
                        </div>
                    `;
                    commentsList.appendChild(commentElement);
                });
            },

            updateStats() {
                const totalComments = samplePosts.reduce((sum, post) => sum + post.comments.length, 0);
                document.getElementById('totalPosts').textContent = samplePosts.length;
                document.getElementById('totalComments').textContent = totalComments;
            },

            simulateActiveUsers() {
                // Simulate random active users between 50-150
                document.getElementById('activeUsers').textContent = Math.floor(Math.random() * 100) + 50;
                // Simulate today's posts between 5-15
                document.getElementById('dailyPosts').textContent = Math.floor(Math.random() * 10) + 5;
                
                // Update every minute to simulate activity
                setInterval(() => {
                    const activeUsers = parseInt(document.getElementById('activeUsers').textContent);
                    const change = Math.floor(Math.random() * 5) - 2; // Random change between -2 and +2
                    document.getElementById('activeUsers').textContent = Math.max(50, activeUsers + change);
                    
                    const dailyPosts = parseInt(document.getElementById('dailyPosts').textContent);
                    if (Math.random() > 0.7) { // 30% chance to increment
                        document.getElementById('dailyPosts').textContent = dailyPosts + 1;
                    }
                }, 60000);
            },

            showNotification(message, type = 'success') {
                const notification = document.getElementById('notification');
                notification.innerHTML = `
                    <i class="fas ${type === 'error' ? 'fa-exclamation-circle' : 
                                      type === 'warning' ? 'fa-exclamation-triangle' : 'fa-check-circle'}"></i>
                    <span>${message}</span>
                `;
                notification.className = `notification ${type} show`;
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            },

            setupEventListeners() {
                // Voting for posts
                document.addEventListener('click', (e) => {
                    if (e.target.closest('.upvote[data-post]')) {
                        const button = e.target.closest('.upvote[data-post]');
                        const postId = parseInt(button.getAttribute('data-post'));
                        const post = samplePosts.find(p => p.id === postId);
                        
                        if (post && !this.votedPosts.has(postId)) {
                            post.upvotes++;
                            button.querySelector('.vote-count').textContent = post.upvotes;
                            button.classList.add('active');
                            this.votedPosts.add(postId);
                            this.showNotification("Upvoted post!");
                        } else {
                            this.showNotification("You've already voted on this post", 'warning');
                        }
                    }
                    
                    if (e.target.closest('.downvote[data-post]')) {
                        const button = e.target.closest('.downvote[data-post]');
                        const postId = parseInt(button.getAttribute('data-post'));
                        const post = samplePosts.find(p => p.id === postId);
                        
                        if (post && !this.votedPosts.has(postId)) {
                            post.downvotes++;
                            button.querySelector('.vote-count').textContent = post.downvotes;
                            button.classList.add('active');
                            this.votedPosts.add(postId);
                            this.showNotification("Downvoted post!");
                        } else {
                            this.showNotification("You've already voted on this post", 'warning');
                        }
                    }
                    
                    // Voting for comments
                    if (e.target.closest('.upvote[data-comment]')) {
                        const button = e.target.closest('.upvote[data-comment]');
                        const commentId = parseInt(button.getAttribute('data-comment'));
                        
                        if (!this.votedComments.has(commentId)) {
                            for (const post of samplePosts) {
                                const comment = post.comments.find(c => c.id === commentId);
                                if (comment) {
                                    comment.upvotes++;
                                    button.querySelector('.vote-count').textContent = comment.upvotes;
                                    button.classList.add('active');
                                    this.votedComments.add(commentId);
                                    this.showNotification("Upvoted comment!");
                                    break;
                                }
                            }
                        } else {
                            this.showNotification("You've already voted on this comment", 'warning');
                        }
                    }
                    
                    if (e.target.closest('.downvote[data-comment]')) {
                        const button = e.target.closest('.downvote[data-comment]');
                        const commentId = parseInt(button.getAttribute('data-comment'));
                        
                        if (!this.votedComments.has(commentId)) {
                            for (const post of samplePosts) {
                                const comment = post.comments.find(c => c.id === commentId);
                                if (comment) {
                                    comment.downvotes++;
                                    button.querySelector('.vote-count').textContent = comment.downvotes;
                                    button.classList.add('active');
                                    this.votedComments.add(commentId);
                                    this.showNotification("Downvoted comment!");
                                    break;
                                }
                            }
                        } else {
                            this.showNotification("You've already voted on this comment", 'warning');
                        }
                    }
                    
                    // Comment submission
                    if (e.target.closest('.comment-submit')) {
                        const button = e.target.closest('.comment-submit');
                        const form = button.closest('.comment-form');
                        const postId = parseInt(form.getAttribute('data-post'));
                        const textarea = form.querySelector('textarea');
                        const content = textarea.value.trim();
                        
                        if (content) {
                            const post = samplePosts.find(p => p.id === postId);
                            if (post) {
                                const newComment = {
                                    id: Math.max(...post.comments.map(c => c.id), 0) + 1,
                                    author: "User_" + Math.floor(Math.random() * 10000),
                                    content,
                                    upvotes: 0,
                                    downvotes: 0,
                                    created_at: new Date().toISOString(),
                                    is_admin: false
                                };
                                post.comments.unshift(newComment);
                                this.renderPosts();
                                this.showNotification("Comment posted successfully!");
                                textarea.value = '';
                            }
                        } else {
                            this.showNotification("Please enter a comment", 'error');
                        }
                    }
                });
                
                // Submit comment on Enter (but allow Shift+Enter for new lines)
                document.addEventListener('keydown', (e) => {
                    if (e.target.matches('.comment-textarea') && e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        e.target.closest('.comment-form').querySelector('.comment-submit').click();
                    }
                });
            }
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            uiController.init();
        });
    </script>
</body>
</html>
